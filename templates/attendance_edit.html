{% extends "layout.html" %}

{% block title %}Edit Attendance | Sikhsha Sathi{% endblock %}

{% block content %}
<div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold flex items-center gap-2">‚úèÔ∏è Edit Attendance</h1>
    <a href="/attendance/history" class="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300">‚¨Ö Back to History</a>
</div>

{% if request.query_params.get('success') == '1' %}
<div class="mb-4 p-3 bg-green-100 text-green-800 rounded-lg">
    ‚úÖ Attendance updated successfully!
</div>
{% endif %}

<div id="editAttendanceTable" {% if request.query_params.get('success') == '1' %}style="display:none"{% endif %}>
    <form method="post" action="/attendance/update/{{ attendance['_id'] }}">
        <input type="hidden" name="course_id" value="{{ course_id }}">
        <input type="hidden" name="date" value="{{ date }}">

        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border rounded-lg">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="px-4 py-2 border">#</th>
                        <th class="px-4 py-2 border">Student Name</th>
                        <th class="px-4 py-2 border">Phone</th>
                        <th class="px-4 py-2 border text-center">Present</th>
                        <th class="px-4 py-2 border text-center">Absent</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr>
                        <td class="px-4 py-2 border">{{ loop.index }}</td>
                        <td class="px-4 py-2 border">{{ student.name }}</td>
                        <td class="px-4 py-2 border">{{ student.phone }}</td>
                        <td class="px-4 py-2 border text-center">
                            <input type="radio" name="status_{{ student._id }}" value="present"
                                   {% if student.status == "Present" %}checked{% endif %}>
                        </td>
                        <td class="px-4 py-2 border text-center">
                            <input type="radio" name="status_{{ student._id }}" value="absent"
                                   {% if student.status == "Absent" %}checked{% endif %}>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="mt-4 flex justify-end gap-2">
            <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">
                Update Attendance
            </button>
            <a href="/attendance/history?course_id={{ course_id }}&date={{ date }}"
               class="px-6 py-2 bg-gray-200 rounded-lg hover:bg-gray-300">üìú View History</a>
        </div>
    </form>
</div>
{% endblock %}
