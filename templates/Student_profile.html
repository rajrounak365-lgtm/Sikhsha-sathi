{% extends "layout.html" %}

{% block title %}Student Profile | Sikhsha Sathi{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto bg-white shadow-md rounded-lg p-6">
  <h1 class="text-2xl font-bold mb-4">Student Profile</h1>

  <!-- Student Details -->
  <ul class="space-y-2 text-gray-700">
    <li><strong>Name:</strong> {{ student.name }}</li>
    <li><strong>Phone:</strong> {{ student.phone }}</li>
    <li><strong>Student Email:</strong> {{ student.student_email}}</li>
    <li><strong>Course:</strong> {{ student.course_name }}</li>
    <li><strong>Joined Date:</strong> {{ student.joined_date }}</li>
    <li><strong>Guardian:</strong> {{ student.guardian_name }} ({{ student.guardian_phone }})</li>
    <li><strong>Village/City:</strong> {{ student.village }}</li>
    <li><strong>Status:</strong> {{ student.status }}</li>
    <li><strong>Payment:</strong> {{ student.payment_status }}</li>
  </ul>

  <!-- Actions -->
  <div class="mt-6 flex space-x-3">
    <a href="/students"
       class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">Back</a>
    <button
      onclick="document.getElementById('editModal').classList.remove('hidden')"
      class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">
      Edit Student
    </button>
    <form action="/students/delete/{{ student._id }}" method="post"
          onsubmit="return confirm('Are you sure you want to delete this student?');">
      <button type="submit"
              class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">
        Delete Student
      </button>
    </form>
  </div>
</div>

<!-- Edit Student Modal -->
<div id="editModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center">
  <div class="bg-white rounded-lg shadow-lg p-6 w-[700px]">
    <h2 class="text-xl font-bold mb-2">Edit Student</h2>
    <p class="text-gray-600 mb-4">Update the student details below</p>

    <form action="/students/update/{{ student._id }}" method="post" class="grid grid-cols-2 gap-4">
      <!-- Name -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Student Name *</label>
        <input type="text" name="name" value="{{ student.name }}" class="w-full border rounded p-2" required>
      </div>

      <!-- Phone -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Phone Number *</label>
        <input type="text" name="phone" value="{{ student.phone }}" class="w-full border rounded p-2" required>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700">Email *</label>
        <input type="text" name="student_email" value="{{ student.email }}" class="w-full border rounded p-2" required>
      </div>
<!-- Select Course -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Select Course *</label>
        <select name="course_id" class="w-full border rounded p-2" required>
          {% for course in courses %}
            <option value="{{ course._id }}" {% if student.course_id == course._id %}selected{% endif %}>
              {{ course.name }} ({{ course.type }})
            </option>
          {% endfor %}
        </select>
      </div>

      <!-- Joined Date -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Joined Date *</label>
        <input type="date" name="joined_date" value="{{ student.joined_date }}" class="w-full border rounded p-2" required>
      </div>

      <!-- Guardian -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Parent/Guardian Name *</label>
        <input type="text" name="guardian_name" value="{{ student.guardian_name }}" class="w-full border rounded p-2" required>
      </div>

      <!-- Guardian Phone -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Parent's Phone *</label>
        <input type="text" name="guardian_phone" value="{{ student.guardian_phone }}" class="w-full border rounded p-2" required>
      </div>

      <!-- Village -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Village/City *</label>
        <input type="text" name="village" value="{{ student.village }}" class="w-full border rounded p-2" required>
      </div>

      <!-- Status -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Status *</label>
        <select name="status" class="w-full border rounded p-2">
          <option value="Active" {% if student.status == "Active" %}selected{% endif %}>Active</option>
          <option value="Inactive" {% if student.status == "Inactive" %}selected{% endif %}>Inactive</option>
        </select>
      </div>

      <!-- Payment -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Fee Payment Option *</label>
        <select name="payment_status" class="w-full border rounded p-2">
          <option value="Paid" {% if student.payment_status == "Paid" %}selected{% endif %}>Paid</option>
          <option value="Pending" {% if student.payment_status == "Pending" %}selected{% endif %}>Pending</option>
          <option value="Pay Later" {% if student.payment_status == "Pay Later" %}selected{% endif %}>Pay Later</option>
          <option value="Partial" {% if student.payment_status == "Partial" %}selected{% endif %}>Partial</option>
        </select>
      </div>

      <!-- Buttons -->
      <div class="col-span-2 flex justify-end space-x-2 mt-4">
        <button type="button"
                onclick="document.getElementById('editModal').classList.add('hidden')"
                class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">
          Cancel
        </button>
        <button type="submit"
                class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">
          Save
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
